# 用户行为数据

## 概述

根据业务场景的需求，进行用户操作行为的数据采集，进一步的进行数据结构化分析

## 数据埋点

### 埋点方式

目前主流的埋点方式,有代码埋点(前端后端)、可视化埋点、全埋点三种。

- 代码埋点是通过调用埋点 SDK 函数,在需要埋点的业务逻辑功能位置调用接口,上报
- 埋点数据我们对页面中的某个按钮埋点后,当这个按钮被点击时,可以在这个按钮
  对应的 OnClick 函数里面调用 SDK 提供的数据发送接口,来发送数据。
  可视化埋点只需要研发人员集成采集 SDK,不需要写埋点代码,业务人员就可以通过
  访问分析平台的“圈选”功能,来“圈出需要对用户行为进行捕捉的控件,并对该事件进
  行命名。圈选完毕后,这些配置会同步到各个用户的终端上,由采集 SDK 按照圈选的配置
  自动进行用户行为数据的采集和发送。
- 全埋点是通过在产品中嵌入 SDK,前端自动采集页面上的全部用户行为事件,上报埋
  点数据,相当于做了一个统一的埋点。然后再通过界面配置哪些数据需要在系统里面进行分析。

当前使用多种埋点进行处理

### 上报时期

> 本项目采用的是第二种

- 离开页面时，减少服务器压力，但不及时
- 每个事件、动作、错误等产生后，立即发送，响应及时，但对服务器有压力

## 目标数据

针对于电商数据分析，收集和分析的数据主要包括以下几点：

- 页面数据
- 事件数据
- 曝光数据
- 启动数据
- 错误数据

## ODS 层数据

数据采集内容

### 页面数据

页面的基本信息

| 序号 | 字段名称       | 字段描述       | 备注                                                              |
| :--: | -------------- | -------------- | ----------------------------------------------------------------- |
|  1   | page_id        | 页面 id        | 比如 login/register/activity/home/category/top_n/search/good_list |
|  2   | last_page_id   | 上页 id        |                                                                   |
|  3   | page_item_type | 页面对象类型   |                                                                   |
|  4   | page_item_id   | 页面对象 id    |                                                                   |
|  5   | source_type    | 页面来源类型   | 比如 promotion("商品推广")                                        |
|  6   | druing_time    | 停留时间(毫秒) |                                                                   |
|  7   | ts             | 跳入时间       |                                                                   |

### 事件数据

| 序号 | 字段名称  | 字段描述     | 备注                                           |
| :--: | --------- | ------------ | ---------------------------------------------- |
|  1   | action_id | 动作 id      | 如：favor_add/favor_canel/cart_add/cart_remove |
|  2   | item_type | 动作目标类型 | 如: sku_id(商品)/coupon_id(购物券)             |
|  3   | item_id   | 动作目标 id  |                                                |
|  4   | ts        | 动作时间     |                                                |

### 曝光数据

| 序号 | 字段名称     | 字段描述     | 备注                                        |
| :--: | ------------ | ------------ | ------------------------------------------- |
|  1   | display_type | 曝光类型     | 如:promotion(商品推广)/query(查询/结果商品) |
|  2   | item_type    | 曝光对象类型 | 如: sku_id(商品)/coupon_id(购物券)          |
|  3   | item_id      | 曝光对象 id  |                                             |
|  4   | order        | 曝光顺序     |                                             |

### 启动数据

启动数据记录应用的启动信息

| 序号 | 字段名称        | 字段描述         | 备注                          |
| :--: | --------------- | ---------------- | ----------------------------- |
|  1   | entry           | 启动入口         | icon(图标)/notification(通知) |
|  2   | loading_time    | 启动加载时间     |                               |
|  3   | open_ad_id      | 开屏广告 id      |                               |
|  4   | open_ad_ms      | 广告播放时间     |                               |
|  5   | open_ad_skip_ms | 用户跳过广告时间 |                               |
|  6   | ts              | 启动时间         |                               |
|  7   | phone_type      | 手机型号         | 如:iPhone8                    |

### 错误数据

错误数据记录应用使用过程中的错误信息

| 序号 | 字段名称   | 字段描述 | 备注 |
| :--: | ---------- | -------- | ---- |
|  1   | error_code | 错误码   |      |
|  2   | message    | 错误信息 |      |

## 其它

- 略

# 接入配置中心

## 概述

在配置管理平台添加配置后，在客户端应用进行集成配置即可调用配置中心的配置



## 本内容你将获得

- 添加配置
- 集成配置中心



## 添加配置

导航 配置管理 > 添加，进入添加配置页

<img src="/technique/config/01_config.png" width="70%">

说明: 

- 配置名称 :  配置中心配置并没有为将配置按不同环境分类，需要客户使用易于辨识各个环境的名称，例： 案件管理服务（测试）
- 配置标识 :  调用配置中心配置所需要用到的标识，对应客户端服务配置 alinesno.configuration.identity，单个账号下不能存在同名标识
- 所属应用 :  配置关联的应用，用于区分配置所属应用
- 配置类型 :  支持 porperties 和 yaml 两种类型
- 导入配置文件 :   支持  yaml，yml，porperties，txt  几种类型文件，导入后会在编辑框中显示
- 编辑框 :  用于编辑配置内容，默认 yaml 格式



## 集成配置中心

添加依赖

```xm
<dependency>
	<groupId>com.alinesno.cloud.configuration</groupId>
	<artifactId>alinesno-cloud-configuration-client</artifactId>
	<version>2.1.3-Alpha</version>
</dependency>
```



客户端服务添加配置(yaml)

```yaml
# 基础配置
alinesno:
  configuration:
    app.open-id: xxxx    # 应用码
    identity: xxxx       # 配置标识
    enabled: true        # 是否启用配置中心
    remote-first: true   #是否远程配置优先，true表示远程配置优先
    center:
      url: http://xxxx   # 配置中心链接

# 当采用网关时，还需要另外添加下面配置
alinesno:
  configuration:
    center:
      gate-token-name: X-GatewayAuth-Token   # 需要添加的头部名, 当前版本为: X-GatewayAuth-Token
      gate-token-value: xxxxxx               # 该头部的值，取网关管理中授权应用的鉴权id

```

说明: 

如果项目采用prppertie配置文件时，改成相应的格式即可 （例： alinesno.configuration.app.open-id=xxxx）



## 其他

#### 添加依赖alinesno-cloud-configuration-client后发现依赖并没有生效

在工程resources目录下添加目录META-INF，在META-INF下添加文件spring.factories，文件写入

```properties
org.springframework.boot.env.PropertySourceLoader=com.alinesno.cloud.configuration.loader.RemotePropertySourceLoader
```

配置完成后重启项目
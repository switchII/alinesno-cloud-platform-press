## IoT 业务架构设计

### 概要

> 此处暂时使用阿里云 IoT 平台介绍

物联网平台为设备提供安全可靠的连接通信能力，向下连接海量设备，支撑设备数据采集上云；
向上提供云端 API，服务端通过调用云端 API 将指令下发至设备端，实现远程控制。

物联网平台也提供了其他增值能力，如设备管理、规则引擎等，为各类 IoT 场景和行业开发者赋能。

### IoT 业务平台架构

<img :src="$withBase('/iot/01_iot_platform_02.png')" >

物联网平台主要提供以下能力。

#### 设备接入

物联网平台支持海量设备连接上云，设备与云端通过 IoT Hub 进行稳定可靠地双向通信。

提供设备端 SDK、驱动、软件包等帮助不同设备、网关轻松接入。
提供蜂窝（2G/3G/4G/5G）、NB-IoT、LoRaWAN、Wi-Fi 等不同网络设备接入方案，解决企业异构网络设备接入管理痛点。
提供 MQTT、CoAP、HTTP/S 等多种协议的设备端 SDK，既满足长连接的实时性需求，也满足短连接的低功耗需求。
开源多种平台设备端代码，提供跨平台移植指导，赋能企业基于多种平台做设备接入。

#### 设备管理

物联网平台提供完整的设备生命周期管理功能，支持设备注册、功能定义、数据解析、在线调试、远程配置、固件升级、远程维护、实时监控、分组管理、设备删除等功能。

- 提供设备物模型，简化应用开发。
- 提供设备上下线变更通知服务，方便实时获取设备状态。
- 提供数据存储能力，方便用户海量设备数据的存储及实时访问。
- 支持 OTA 升级，赋能设备远程升级。
- 提供设备影子缓存机制，将设备与应用解耦，解决不稳定无线网络下的通信不可靠痛点。

#### 安全能力

物联网平台提供多重防护，有效保障设备和云端数据的安全。

##### 身份认证

- 提供芯片级安全存储方案（ID²）及设备密钥安全管理机制，防止设备密钥被破解。安全级别很高。
- 提供一机一密的设备认证机制，降低设备被攻破的安全风险。适合有能力批量预分配设备证书（ProductKey、DeviceName 和 DeviceSecret），将设备证书信息烧入到每个设备的芯片。安全级别高。
- 提供一型一密的设备认证机制。设备预烧产品证书（ProductKey 和 ProductSecret），认证时动态获取设备证书（包括 ProductKey、DeviceName 和 DeviceSecret）。适合批量生产时无法将设备证书烧入每个设备的情况。安全级别普通。
- 提供 X.509 证书的设备认证机制，支持基于 MQTT 协议直连的设备使用 X.509 证书进行认证。安全级别很高。

#### 通信安全

- 支持 TLS（MQTT\HTTP）、DTLS（CoAP）数据传输通道，保证数据的机密性和完整性，适用于硬件资源充足、对功耗不是很敏感的设备。安全级别高。
- 支持设备权限管理机制，保障设备与云端安全通信。
- 支持设备级别的通信资源（Topic 等）隔离，防止设备越权等问题。

#### 规则引擎

物联网平台规则引擎包含以下功能：

- 服务端订阅：订阅某产品下所有设备的某个或多个类型消息，您的服务端可以通过 AMQP 客户端或消息服务（MNS）客户端获取订阅的消息。
- 云产品流转：物联网平台根据您配置的数据流转规则，将指定 Topic 消息的指定字段流转到目的地，进行存储和计算处理。
- 将数据转发到另一个设备的 Topic 中，实现设备与设备之间的通信。
- 如果购买了实例，将数据转发到实例内的时序数据存储，实现设备时序数据的高效写入。
- 将数据转发到 AMQP 服务端订阅消费组，您的服务端通过 AMQP 客户端监听消费组获取消息。
- 将数据转发到消息服务（MNS）和消息队列（RocketMQ）中，保障应用消费设备数据的稳定可靠性。
- 将数据转发到表格存储（Table Store），提供设备数据采集 + 结构化存储的联合方案。
- 将数据转发到云数据库（RDS）中，提供设备数据采集+关系型数据库存储的联合方案。
- 将数据转发到 DataHub 中，提供设备数据采集 + 大数据计算的联合方案。
- 将数据转发到时序时空数据库（TSDB），提供设备数据采集 + 时序数据存储的联合方案。
- 将数据转发到函数计算中，提供设备数据采集 + 事件计算的联合方案。
- 场景联动：配置简单规则，即可将设备数据无缝流转至其他设备，实现设备联动。

## 其它

- 略

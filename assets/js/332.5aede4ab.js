(window.webpackJsonp=window.webpackJsonp||[]).push([[332],{705:function(t,a,s){"use strict";s.r(a);var n=s(8),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"接入配置中心"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#接入配置中心"}},[t._v("#")]),t._v(" 接入配置中心")]),t._v(" "),a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),a("p",[t._v("在配置管理平台添加配置后，在客户端应用进行集成配置即可调用配置中心的配置")]),t._v(" "),a("h2",{attrs:{id:"本内容你将获得"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本内容你将获得"}},[t._v("#")]),t._v(" 本内容你将获得")]),t._v(" "),a("ul",[a("li",[t._v("添加配置")]),t._v(" "),a("li",[t._v("集成配置中心")])]),t._v(" "),a("h2",{attrs:{id:"添加配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加配置"}},[t._v("#")]),t._v(" 添加配置")]),t._v(" "),a("p",[t._v("导航 配置管理 > 添加，进入添加配置页")]),t._v(" "),a("img",{attrs:{src:"/technique/config/01_config.png",width:"70%"}}),t._v(" "),a("p",[t._v("说明:")]),t._v(" "),a("ul",[a("li",[t._v("配置名称 :  配置中心配置并没有为将配置按不同环境分类，需要客户使用易于辨识各个环境的名称，例： 案件管理服务（测试）")]),t._v(" "),a("li",[t._v("配置标识 :  调用配置中心配置所需要用到的标识，对应客户端服务配置 alinesno.configuration.identity，单个账号下不能存在同名标识")]),t._v(" "),a("li",[t._v("所属应用 :  配置关联的应用，用于区分配置所属应用")]),t._v(" "),a("li",[t._v("配置类型 :  支持 porperties 和 yaml 两种类型")]),t._v(" "),a("li",[t._v("导入配置文件 :   支持  yaml，yml，porperties，txt  几种类型文件，导入后会在编辑框中显示")]),t._v(" "),a("li",[t._v("编辑框 :  用于编辑配置内容，默认 yaml 格式")])]),t._v(" "),a("h2",{attrs:{id:"集成配置中心"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成配置中心"}},[t._v("#")]),t._v(" 集成配置中心")]),t._v(" "),a("p",[t._v("添加依赖")]),t._v(" "),a("div",{staticClass:"language-xm extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<dependency>\n\t<groupId>com.alinesno.cloud.configuration</groupId>\n\t<artifactId>alinesno-cloud-configuration-client</artifactId>\n\t<version>2.1.3-Alpha</version>\n</dependency>\n")])])]),a("p",[t._v("客户端服务添加配置(yaml)")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基础配置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("alinesno")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app.open-id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xxxx    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 应用码")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("identity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xxxx       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置标识")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否启用配置中心")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("remote-first")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否远程配置优先，true表示远程配置优先")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("center")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//xxxx   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置中心链接")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当采用网关时，还需要另外添加下面配置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("alinesno")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("center")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gate-token-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" X"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("GatewayAuth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("Token   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 需要添加的头部名, 当前版本为: X-GatewayAuth-Token")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gate-token-value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" xxxxxx               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该头部的值，取网关管理中授权应用的鉴权id")]),t._v("\n\n")])])]),a("p",[t._v("说明:")]),t._v(" "),a("p",[t._v("如果项目采用prppertie配置文件时，改成相应的格式即可 （例： alinesno.configuration.app.open-id=xxxx）")]),t._v(" "),a("h2",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),a("h4",{attrs:{id:"添加依赖alinesno-cloud-configuration-client后发现依赖并没有生效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖alinesno-cloud-configuration-client后发现依赖并没有生效"}},[t._v("#")]),t._v(" 添加依赖alinesno-cloud-configuration-client后发现依赖并没有生效")]),t._v(" "),a("p",[t._v("在工程resources目录下添加目录META-INF，在META-INF下添加文件spring.factories，文件写入")]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("org.springframework.boot.env.PropertySourceLoader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("com.alinesno.cloud.configuration.loader.RemotePropertySourceLoader")]),t._v("\n")])])]),a("p",[t._v("配置完成后重启项目")])])}),[],!1,null,null,null);a.default=e.exports}}]);
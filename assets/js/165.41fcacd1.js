(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{537:function(a,s,t){"use strict";t.r(s);var n=t(8),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"elk单机版本安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elk单机版本安装"}},[a._v("#")]),a._v(" elk单机版本安装")]),a._v(" "),s("h2",{attrs:{id:"本内容你将获得"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本内容你将获得"}},[a._v("#")]),a._v(" 本内容你将获得")]),a._v(" "),s("ul",[s("li",[a._v("ELK 单机版本安装")]),a._v(" "),s("li",[a._v("启动并配置 logstash 配置(此处只为 demo)")])]),a._v(" "),s("h2",{attrs:{id:"docker快速体验"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker快速体验"}},[a._v("#")]),a._v(" docker快速体验")]),a._v(" "),s("p",[a._v("以下快速体验只为开发过程临时使用，数据未做安全配置，方便用于开发过程")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" acp-es  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--restart")]),a._v(" always "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),a._v(":9200 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9300")]),a._v(":9300 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /mnt/elasticsearch/data:/usr/share/elasticsearch/data "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"discovery.type=single-node"')]),a._v(" elasticsearch:7.16.2\n")])])]),s("p",[a._v("以上配置，数据库的数据映射到本地"),s("code",[a._v("/mnt/elasticsearch/data")]),a._v("目录下，查看运行状态")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" elasticsearch\n")])])]),s("h2",{attrs:{id:"elk-安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#elk-安装"}},[a._v("#")]),a._v(" elk 安装")]),a._v(" "),s("h3",{attrs:{id:"说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[a._v("#")]),a._v(" 说明")]),a._v(" "),s("p",[a._v("单机版安装只为用于学习使用，生产中请使用集群模式，此处以阿里云服务器做为示例用于学习,")]),a._v(" "),s("h3",{attrs:{id:"上传软件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上传软件"}},[a._v("#")]),a._v(" 上传软件")]),a._v(" "),s("p",[a._v("上传 Jenkins 至 Linux 服务器"),s("code",[a._v("/home/alinesno/elk")]),a._v("目录")]),a._v(" "),s("blockquote",[s("p",[a._v("此处用户可以使用 xftp 或者 xshell 等工具，书要简言")])]),a._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("blockquote",[s("p",[a._v("elk 启动需要使用非 root 用户操作，所以此处添加 elk 用户，并用此用户操作，生产也强烈建议以非 root 操作")])]),a._v(" "),s("p",[a._v("添加 elk 用户")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" elk\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 如果需要设置密码则做如此操作")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("passwd")]),a._v(" elk\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" elk\n")])])]),s("p",[a._v("解压 es,并启动，一般无非端口或者内存的原因，这步一般情况下是很顺利的")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" elasticsearch-6.5.1.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重命名文件夹")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" elasticsearch-6.5.1  elasticsearch\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" elasticsearch\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -d 表示后面运行")]),a._v("\n./bin/elasticsearch "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看启动日志")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" logs/elasticsearch.log\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看进程是否存在")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" -ef"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" elasticsearch\n")])])]),s("p",[a._v("解压 logstash")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" logstash-6.5.1.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" logstash-6.5.1 logstash\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" logstash\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看示例配置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" config/logstash-sample.conf\n")])])]),s("p",[a._v("此处为与 alinesno-cloud 平台整合，所以添加以下配置,编辑文件名称为"),s("code",[a._v("logstash.conf")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" config/logstash.conf\n")])])]),s("p",[a._v("配置内容如下，这里启动了一个 tcp 服务，端口是 4567，然后向本地的 es 输入")]),a._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[a._v("input"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    tcp "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        mode => "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"server"')]),a._v("\n        host => "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.0.0.0"')]),a._v("\n        port => "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4567")]),a._v("\n        codec => json_lines\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\noutput"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    elasticsearch "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        hosts=>"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:9200"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        index => "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"alinesno-cloud-%{+YYYY.MM.dd}"')]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    stdout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        codec => rubydebug\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("启动 logstash")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" logstash\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nohup")]),a._v(" ./bin/logstash "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" ./config/logstash\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" nohup.out\n")])])]),s("p",[a._v("安装 kibana 客户端")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" kibana-6.5.1-linux-x86_64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" kibana-6.5.1-linux-x86_64 kibana\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nohup")]),a._v(" bin/kibana "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n")])])]),s("p",[a._v("访问"),s("code",[a._v("http://localhost:5601")]),a._v("，见如下界面:")]),a._v(" "),s("img",{attrs:{src:a.$withBase("/operation/kibana_01.png")}})])}),[],!1,null,null,null);s.default=e.exports}}]);
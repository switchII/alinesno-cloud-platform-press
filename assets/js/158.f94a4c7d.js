(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{530:function(a,s,t){"use strict";t.r(s);var e=t(8),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"mysql8-单点教程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql8-单点教程"}},[a._v("#")]),a._v(" MySQL8 单点教程")]),a._v(" "),s("h2",{attrs:{id:"你将获取"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#你将获取"}},[a._v("#")]),a._v(" 你将获取")]),a._v(" "),s("ul",[s("li",[a._v("docker快速安装mysql8")]),a._v(" "),s("li",[a._v("生产环境安装使用mysql8")])]),a._v(" "),s("h2",{attrs:{id:"docker快速体验"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker快速体验"}},[a._v("#")]),a._v(" docker快速体验")]),a._v(" "),s("p",[a._v("以下快速体验只为开发过程临时使用，数据未做安全配置")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(":3306 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /opt/acp-mysql8/data:/var/lib/mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  \t"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /opt/acp-mysql8/my.cnf:/etc/mysql/conf.d/my.cnf "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_ROOT_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Admin123"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" acp-mysql8 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\t"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" registry.cn-shenzhen.aliyuncs.com/alinesno-base/mysql:8.0.18\n")])])]),s("p",[a._v("以上配置，数据库的数据映射到本地"),s("code",[a._v("/opt/acp-mysql8")]),a._v("目录下，查看运行状态")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" mysql\n")])])]),s("p",[a._v("安装完成访问账号密码为：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("账号: root\n密码: Admin123"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),a._v("\n")])])]),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("blockquote",[s("p",[a._v("安装过程使用 root 操作")])]),a._v(" "),s("p",[a._v("上传软件至 Linux 服务器"),s("code",[a._v("/home/alinesno/soft/")]),a._v("目录")]),a._v(" "),s("blockquote",[s("p",[a._v("此处用户可以使用 xftp 或者 xshell 等工具，书要简言")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" mysql-server-mysql-5.7.24.tar.gz root@192.168.1.110:/opt/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" boost_1_59_0.tar.gz root@192.168.1.110:/opt/\n")])])]),s("p",[a._v("安装依赖软件")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" cmake , "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" , gcc , gcc-c++ , bison , ncurses , ncurses-devel\n")])])]),s("p",[a._v("解压包")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" boost_1_59_0.tar.gz "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" /usr/local/\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" mysql-server-mysql-5.7.24.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" mysql-server-mysql-5.7.24\n")])])]),s("p",[a._v("初始化用户,添加 mysql 用户组和 mysql 用户")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("groupadd")]),a._v(" mysql\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("useradd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-g")]),a._v(" mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" /bin/false mysql\n")])])]),s("p",[a._v("编译源码,其中参数说明")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("cmake "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DCMAKE_INSTALL_PREFIX")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DMYSQL_DATADIR")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/data "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DWITH_BOOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/boost_1_59_0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DSYSCONFDIR")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/etc "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DEFAULT_CHARSET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8mb4 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DDEFAULT_COLLATION")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8mb4_general_ci "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DENABLED_LOCAL_INFILE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DEXTRA_CHARSETS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("all\n")])])]),s("ul",[s("li",[a._v("DCMAKE_INSTALL_PREFIX：安装路径")]),a._v(" "),s("li",[a._v("DMYSQL_DATADIR：数据存放目录")]),a._v(" "),s("li",[a._v("DWITH_BOOST：boost 源码路径")]),a._v(" "),s("li",[a._v("DSYSCONFDIR：my.cnf 配置文件目录")]),a._v(" "),s("li",[a._v("DEFAULT_CHARSET：数据库默认字符编码")]),a._v(" "),s("li",[a._v("DDEFAULT_COLLATION：默认排序规则")]),a._v(" "),s("li",[a._v("DENABLED_LOCAL_INFILE：允许从本文件导入数据")]),a._v(" "),s("li",[a._v("DEXTRA_CHARSETS：安装所有字符集")])]),a._v(" "),s("p",[a._v("编译安装")]),a._v(" "),s("blockquote",[s("p",[a._v("-j 参数表示根据 CPU 核数指定编译时的线程数，可以加快编译速度")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" processor /proc/cpuinfo "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wc")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-l")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])])]),s("h2",{attrs:{id:"配置数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置数据库"}},[a._v("#")]),a._v(" 配置数据库")]),a._v(" "),s("p",[a._v("初始化数据库")]),a._v(" "),s("blockquote",[s("p",[a._v("注意：如果使用–initialize 参数初始化系统数据库之后，会在~/.mysql_secret 文件中生成 root 用户的一个临时密码，同时也在初始化日志中打印出来了,如下图:")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /usr/local/mysql\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" mysql:mysql "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n./bin/mysqld --initialize-insecure "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--basedir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--datadir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/data\n./bin/mysql_ssl_rsa_setup\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" root "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-R")]),a._v(" mysql data\n")])])]),s("p",[a._v("查看初始密码:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" ~/.mysql_secret\n")])])]),s("p",[a._v("复制配置文件")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" support-files/my-default.cnf /etc/my.cnf\n")])])]),s("p",[a._v("参数优化,编辑文件"),s("code",[a._v("/etc/my.conf")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/my.conf\n")])])]),s("p",[a._v("调整内容如下")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("socket")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/mysql.sock\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysqld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\ncharacter-set-server"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8\ncollation-server"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8_general_ci\n\nskip-external-locking\nskip-name-resolve\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("basedir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("datadir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/data\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("tmpdir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/temp\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# server_id = .....")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("socket")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/mysql.sock\nlog-error"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/logs/mysql_error.log\npid-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/mysql.pid\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("open_files_limit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10240")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("back_log")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("600")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("max_connections")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("500")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("max_connect_errors")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("wait_timeout")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("605800")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#open_tables=600")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#table_cache = 650")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#opened_tables = 630")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("max_allowed_packet")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("32M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("sort_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("4M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("join_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("4M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("thread_cache_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("300")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("query_cache_type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("query_cache_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("256M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("query_cache_limit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("2M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("query_cache_min_res_unit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("16k\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("tmp_table_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("256M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("max_heap_table_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("256M\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("key_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("256M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("read_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("1M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("read_rnd_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("16M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("bulk_insert_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("64M\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("lower_case_table_names")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\ndefault-storage-engine"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("INNODB\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("innodb_buffer_pool_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("2G\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("innodb_log_buffer_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("32M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("innodb_log_file_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("128M\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("innodb_flush_method")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("O_DIRECT\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#####################")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("thread_concurrency")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("long_query_time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\nslow-query-log"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("on\nslow-query-log-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/logs/mysql-slow.log\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysqldump"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nquick\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("max_allowed_packet")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("32M\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysqld_safe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nlog-error"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/var/log/mysqld.log\npid-file"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/var/run/mysqld/mysqld.pid\n")])])]),s("p",[a._v("配置启动服务")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" support-files/mysql.server /etc/init.d/mysqld\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chkconfig")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--add")]),a._v(" mysqld\n")])])]),s("p",[a._v("启动数据库")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动mysql服务")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" mysqld start\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止mysql服务")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" mysqld stop\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重新启动mysql服务")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" mysqld restart\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 开机启动")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" mysqld "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v("\n")])])]),s("p",[a._v("设置数据库密码,及远程登陆")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("/usr/local/mysql/bin/mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"grant all privileges on *.* to root@'127.0.0.1' identified by \"")]),a._v("1234qwer"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" with grant option;"')]),a._v("\n/usr/local/mysql/bin/mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"grant all privileges on *.* to root@'localhost' identified by \"")]),a._v("1234qwer"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" with grant option;"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 开启远程登录(将host设为%即可),生产当中极不建议这么做")]),a._v("\n/usr/local/mysql/bin/mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"grant all privileges on *.* to root@'%' identified by \"")]),a._v("1234qwer"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" with grant option;"')]),a._v("\n")])])]),s("p",[a._v("配置环境变量,编辑"),s("code",[a._v("/etc/profile")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/profile\n")])])]),s("p",[a._v("添加以下内容")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mysql env")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/mysql/bin:"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/profile\n")])])]),s("h2",{attrs:{id:"ansible-构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ansible-构建"}},[a._v("#")]),a._v(" Ansible 构建")]),a._v(" "),s("ul",[s("li",[a._v("脚本编写")])]),a._v(" "),s("h2",{attrs:{id:"镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#镜像"}},[a._v("#")]),a._v(" 镜像")]),a._v(" "),s("ul",[s("li",[a._v("构建镜像")]),a._v(" "),s("li",[a._v("使用")])]),a._v(" "),s("h2",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://www.baidu.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("GitBook 官网"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/xyang81/article/details/51792144",target:"_blank",rel:"noopener noreferrer"}},[a._v("MySQL5.7.13 源码编译安装与配置"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://dev.mysql.com/doc/refman/5.7/en/installing-source-distribution.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Installing MySQL Using a Standard Source Distribution"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);